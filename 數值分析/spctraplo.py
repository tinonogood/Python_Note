#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Jan 16 17:57:40 2017

@author: tino
"""        
import time
start_time = time.time()


import math
import util
import numpy as np
import matplotlib.pyplot as plt
dict_E_T_Threads = [] 


#==============================================================================
# PARAMETERS OF SYS

LATTICE_A = 9.49569 * math.pow(10, -10) # m
LATTICE_B = 9.49569 * math.pow(10, -10) # m
ACTIVE_SITE = 6 / (LATTICE_A * LATTICE_B) 
BETA = 3 # K/sec
TOTAL_PRESSURE = 2 * math.pow(10, -10) # atm
TEMPERATURE = 500 # K
#==============================================================================
    
#==============================================================================
# PARAMETER OF NH3

GAS_MASS = 17.001 / (6 * math.pow(10, 23) * 1000) # kg /atom
ROT_CONST_A = 610.85 # 1/m
ROT_CONST_B = 983.86 # 1/m
ROT_CONST_C = 983.91 # 1/m
SIGMA = 3
HVS_GAS = [435.460659, 431.205986, 415.541526, 203.517923, 201.833141, 120.027150] # meV
#==============================================================================

##==============================================================================
## 1xnh3@RuO2 frequency (cm-1)
#
#SURFACE = [702.5384, 667.3163, 666.8468, 637.0404, 632.6593, 619.8975, 619.8880, 594.6102, 565.8163, 549.3752, 535.0747, 533.3084, 531.2641, 526.4177, 525.8286, 510.1579, 494.7568, 494.3726, 491.6280, 489.0763, 480.0920, 468.2642, 435.4031, 434.9185, 366.7504, 319.1306, 318.9866, 313.6116, 280.4454, 277.8176, 277.7921, 256.1764, 253.9295, 251.0983, 250.5850, 238.4942, 234.3757, 228.4755, 227.8496, 213.4265, 213.0562, 208.7910, 197.7978, 195.4322, 155.2341, 150.9349, 150.7593, 150.6323, 142.9187, 138.6253, 138.3549, 119.8644, 119.2399, 113.8064, 109.3032, 108.8512, 104.3528, 86.9122, 73.1832, 22.8849]
#ADSORBENT = [3497.8656, 3470.6895, 3357.7690, 1612.5701, 1600.9326, 1183.3037, 719.5083, 693.4747, 692.7758, 668.3197, 652.8541, 633.7733, 617.3873, 612.5937, 611.8252, 589.7271, 579.3086, 568.4171, 548.1430, 544.2284, 541.5081, 531.2811, 525.1468, 521.1906, 516.3771, 511.2057, 505.1219, 497.6588, 484.5486, 479.2293, 474.5780, 450.5895, 435.0337, 381.6198, 345.6290, 341.5104, 309.1609, 293.0269, 287.1928, 285.3356, 285.0449, 280.7592, 277.3797, 260.9612, 259.1692, 254.9810, 251.2341, 248.6749, 246.2514, 233.4536, 227.0563, 223.6744, 221.7741, 208.7098, 207.1964, 202.0659, 201.4852, 198.8288, 187.8602, 184.9007, 177.7483, 169.9000, 164.6706, 159.0970, 146.6093, 138.8189, 133.0448, 130.0533, 120.7778, 95.2894, 91.4410, 59.2641]
#
##==============================================================================


#==============================================================================
# 2xnh3@RuO2 frequency (cm-1)

SURFACE = [3497.8656, 3470.6895, 3357.7690, 1612.5701, 1600.9326, 1183.3037, 719.5083, 693.4747, 692.7758, 668.3197, 652.8541, 633.7733, 617.3873, 612.5937, 611.8252, 589.7271, 579.3086, 568.4171, 548.1430, 544.2284, 541.5081, 531.2811, 525.1468, 521.1906, 516.3771, 511.2057, 505.1219, 497.6588, 484.5486, 479.2293, 474.5780, 450.5895, 435.0337, 381.6198, 345.6290, 341.5104, 309.1609, 293.0269, 287.1928, 285.3356, 285.0449, 280.7592, 277.3797, 260.9612, 259.1692, 254.9810, 251.2341, 248.6749, 246.2514, 233.4536, 227.0563, 223.6744, 221.7741, 208.7098, 207.1964, 202.0659, 201.4852, 198.8288, 187.8602, 184.9007, 177.7483, 169.9000, 164.6706, 159.0970, 146.6093, 138.8189, 133.0448, 130.0533, 120.7778, 95.2894, 91.4410, 59.2641]
ADSORBENT = [3516.9722, 3515.5323, 3473.0013, 3458.0886, 3303.3419, 3302.2752, 1609.2710, 1602.6009, 1600.7046, 1597.6492, 1152.2745, 1148.2184, 707.6653, 705.0673, 682.5034, 674.4021, 667.5327, 664.6650, 651.6761, 629.8905, 618.9749, 614.5584, 606.8933, 583.7344, 569.8709, 562.2350, 547.6579, 538.4472, 536.6192, 522.1164, 519.4816, 519.3970, 510.3790, 505.5104, 499.7026, 494.1250, 490.5474, 459.5844, 450.0938, 424.1161, 419.7064, 412.6220, 378.3775, 351.0181, 347.9084, 314.7065, 302.4543, 292.4138, 288.7438, 287.2433, 286.0263,284.4821, 279.3479, 267.5245, 262.2817, 249.6816, 247.9556, 240.3105, 234.0109, 231.3826, 228.3204, 223.9515, 222.8543, 219.0760, 211.3421, 205.4867, 192.5066, 190.3807, 189.7151, 182.6210, 181.8169, 177.1669, 163.6604, 157.5056, 153.3648, 143.5899, 140.3938, 129.1110, 119.3116, 105.6124, 98.8605, 92.9211, 91.7946, 64.3201]

#==============================================================================


H_eV = 4.135667662 * math.pow(10, -15)  # H_PLANCK_eV, eV.sec
C = 299792458  # speed of light m/s
HVS_SURFACE = [H_eV * C * (i * 100) * 1000 for i in SURFACE] # convert to meV
HVS_ADSORBENT = [H_eV * C * (i * 100)* 1000 for i in ADSORBENT]
KB_EV = 8.6173324 * math.pow(10, -5)  # K_BOLTZMANN_EV. eV/K

adsorbent = util.Adsorbent(HVS_SURFACE, HVS_ADSORBENT)
adsorbent.set_sys_parameter(LATTICE_A, LATTICE_B, ACTIVE_SITE, BETA, TOTAL_PRESSURE, TEMPERATURE)
adsorbent.set_gas_parameters(GAS_MASS, ROT_CONST_A, ROT_CONST_B, ROT_CONST_C, SIGMA, HVS_GAS)

d1 = adsorbent.get_E_t_list()


#print(HVS_ADSORBENT)
#print(HVS_SURFACE)


## normal distribution
#
E_zpe = 1.3
for sigma in np.linspace(0.05, 0.65, 4, endpoint=True):
    print('sigma', sigma)
    E_checks = []
    N0_of_E_cals = []
    for E_check in np.linspace(E_zpe - 3 * sigma, E_zpe + 3 * sigma, 21, endpoint=True):
        T = adsorbent.get_T(E_check)
        adsorbent.temperature = T
        fs = []
        N0s_of_E_guess = []
        for E in np.linspace(E_check - 2 * KB_EV * T, E_check + 4 * KB_EV * T, 256, endpoint=True):
            f = adsorbent.get_f_energy_distribution(E)
            fs.append(f)
            N0s_of_E_guess.append(1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)))
        rd_sec = [i * j * (6 * KB_EV * T / 255) for i, j in zip(fs, N0s_of_E_guess)]
        rd = sum(rd_sec)
        N0_of_E_cal = rd / (BETA * (E_check / T))
        E_checks.append(E_check)
        N0_of_E_cals.append(N0_of_E_cal)
    E = np.linspace(E_zpe - 3 * sigma, E_zpe + 3 * sigma, 256, endpoint=True)
    plt.plot(E, 1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)),linewidth=2, color='r')
    plt.plot(E_checks, N0_of_E_cals)
    print((N0_of_E_cals[10] - 1/(sigma * np.sqrt(2 * np.pi))) / (1/(sigma * np.sqrt(2 * np.pi))))
    plt.show()
    plt.plot()
        
        
        
#        
#        E = np.linspace(E_zpe - 2 * sigma, E_zpe + 2 * sigma, 256, endpoint=True)
#        f2 = np.vectorize(adsorbent.get_f_energy_distribution)
#        plt.plot(E, f2(E))
#        print(E_check, N0_of_E_cal)
##    
#sigma = 0.05
#E = np.linspace(E_zpe - 4 * sigma, E_zpe + 4 * sigma, 256, endpoint=True)
#plt.plot(E, 1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)),linewidth=2, color='r')

#poisson distribution



print("--- %s seconds ---" % (time.time() - start_time))


        
if __name__ == "__main__":
    pass
