#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Jan 16 17:57:40 2017

@author: tino
"""        
import time
start_time = time.time()


import math
import util
import numpy as np
import matplotlib.pyplot as plt
dict_E_T_Threads = [] 


#==============================================================================
# PARAMETERS OF SYS

LATTICE_A = 9.49569 * math.pow(10, -10) # m
LATTICE_B = 9.49569 * math.pow(10, -10) # m
#ACTIVE_SITE = 6 / (LATTICE_A * LATTICE_B)
ACTIVE_SITE = 5.05 * math.pow(10, 18)
BETA = 3 # K/sec
TOTAL_PRESSURE = 2 * math.pow(10, -10) # atm
TEMPERATURE = 500 # K
#==============================================================================
    
#==============================================================================
# PARAMETER OF NH3

GAS_MASS = 17.001 / (6 * math.pow(10, 23) * 1000) # kg /atom
ROT_CONST_A = 610.85 # 1/m
ROT_CONST_B = 983.86 # 1/m
ROT_CONST_C = 983.91 # 1/m
SIGMA = 3
HVS_GAS = [435.460659, 431.205986, 415.541526, 203.517923, 201.833141, 120.027150] # meV
#==============================================================================

#==============================================================================
# 1xnh3@RuO2 frequency (cm-1)

SURFACE = [702.5384, 667.3163, 666.8468, 637.0404, 632.6593, 619.8975, 619.8880, 594.6102, 565.8163, 549.3752, 535.0747, 533.3084, 531.2641, 526.4177, 525.8286, 510.1579, 494.7568, 494.3726, 491.6280, 489.0763, 480.0920, 468.2642, 435.4031, 434.9185, 366.7504, 319.1306, 318.9866, 313.6116, 280.4454, 277.8176, 277.7921, 256.1764, 253.9295, 251.0983, 250.5850, 238.4942, 234.3757, 228.4755, 227.8496, 213.4265, 213.0562, 208.7910, 197.7978, 195.4322, 155.2341, 150.9349, 150.7593, 150.6323, 142.9187, 138.6253, 138.3549, 119.8644, 119.2399, 113.8064, 109.3032, 108.8512, 104.3528, 86.9122, 73.1832, 22.8849]
ADSORBENT = [3497.8656, 3470.6895, 3357.7690, 1612.5701, 1600.9326, 1183.3037, 719.5083, 693.4747, 692.7758, 668.3197, 652.8541, 633.7733, 617.3873, 612.5937, 611.8252, 589.7271, 579.3086, 568.4171, 548.1430, 544.2284, 541.5081, 531.2811, 525.1468, 521.1906, 516.3771, 511.2057, 505.1219, 497.6588, 484.5486, 479.2293, 474.5780, 450.5895, 435.0337, 381.6198, 345.6290, 341.5104, 309.1609, 293.0269, 287.1928, 285.3356, 285.0449, 280.7592, 277.3797, 260.9612, 259.1692, 254.9810, 251.2341, 248.6749, 246.2514, 233.4536, 227.0563, 223.6744, 221.7741, 208.7098, 207.1964, 202.0659, 201.4852, 198.8288, 187.8602, 184.9007, 177.7483, 169.9000, 164.6706, 159.0970, 146.6093, 138.8189, 133.0448, 130.0533, 120.7778, 95.2894, 91.4410, 59.2641]

#==============================================================================


##==============================================================================
## 2xnh3@RuO2 frequency (cm-1)
#
#SURFACE = [3497.8656, 3470.6895, 3357.7690, 1612.5701, 1600.9326, 1183.3037, 719.5083, 693.4747, 692.7758, 668.3197, 652.8541, 633.7733, 617.3873, 612.5937, 611.8252, 589.7271, 579.3086, 568.4171, 548.1430, 544.2284, 541.5081, 531.2811, 525.1468, 521.1906, 516.3771, 511.2057, 505.1219, 497.6588, 484.5486, 479.2293, 474.5780, 450.5895, 435.0337, 381.6198, 345.6290, 341.5104, 309.1609, 293.0269, 287.1928, 285.3356, 285.0449, 280.7592, 277.3797, 260.9612, 259.1692, 254.9810, 251.2341, 248.6749, 246.2514, 233.4536, 227.0563, 223.6744, 221.7741, 208.7098, 207.1964, 202.0659, 201.4852, 198.8288, 187.8602, 184.9007, 177.7483, 169.9000, 164.6706, 159.0970, 146.6093, 138.8189, 133.0448, 130.0533, 120.7778, 95.2894, 91.4410, 59.2641]
#ADSORBENT = [3516.9722, 3515.5323, 3473.0013, 3458.0886, 3303.3419, 3302.2752, 1609.2710, 1602.6009, 1600.7046, 1597.6492, 1152.2745, 1148.2184, 707.6653, 705.0673, 682.5034, 674.4021, 667.5327, 664.6650, 651.6761, 629.8905, 618.9749, 614.5584, 606.8933, 583.7344, 569.8709, 562.2350, 547.6579, 538.4472, 536.6192, 522.1164, 519.4816, 519.3970, 510.3790, 505.5104, 499.7026, 494.1250, 490.5474, 459.5844, 450.0938, 424.1161, 419.7064, 412.6220, 378.3775, 351.0181, 347.9084, 314.7065, 302.4543, 292.4138, 288.7438, 287.2433, 286.0263,284.4821, 279.3479, 267.5245, 262.2817, 249.6816, 247.9556, 240.3105, 234.0109, 231.3826, 228.3204, 223.9515, 222.8543, 219.0760, 211.3421, 205.4867, 192.5066, 190.3807, 189.7151, 182.6210, 181.8169, 177.1669, 163.6604, 157.5056, 153.3648, 143.5899, 140.3938, 129.1110, 119.3116, 105.6124, 98.8605, 92.9211, 91.7946, 64.3201]
#
##==============================================================================


##==============================================================================
## 3xnh3@RuO2 frequency (cm-1)
#
#SURFACE = [3516.9722, 3515.5323, 3473.0013, 3458.0886, 3303.3419, 3302.2752, 1609.2710, 1602.6009, 1600.7046, 1597.6492, 1152.2745, 1148.2184, 707.6653, 705.0673, 682.5034, 674.4021, 667.5327, 664.6650, 651.6761, 629.8905, 618.9749, 614.5584, 606.8933, 583.7344, 569.8709, 562.2350, 547.6579, 538.4472, 536.6192, 522.1164, 519.4816, 519.3970, 510.3790, 505.5104, 499.7026, 494.1250, 490.5474, 459.5844, 450.0938, 424.1161, 419.7064, 412.6220, 378.3775, 351.0181, 347.9084, 314.7065, 302.4543, 292.4138, 288.7438, 287.2433, 286.0263,284.4821, 279.3479, 267.5245, 262.2817, 249.6816, 247.9556, 240.3105, 234.0109, 231.3826, 228.3204, 223.9515, 222.8543, 219.0760, 211.3421, 205.4867, 192.5066, 190.3807, 189.7151, 182.6210, 181.8169, 177.1669, 163.6604, 157.5056, 153.3648, 143.5899, 140.3938, 129.1110, 119.3116, 105.6124, 98.8605, 92.9211, 91.7946, 64.3201]
#ADSORBENT = [3538.3506, 3522.0846, 3504.3004, 3489.0278, 3447.5464, 3431.0330, 3362.1889, 3258.9233, 3255.7080, 1641.6623, 1625.8851, 1614.2798, 1595.1031, 1576.7513, 1572.4746, 1134.0256, 1125.4126, 1088.5196, 701.7824, 698.8095, 677.5906, 673.7143, 661.4035, 653.9864, 649.6279, 634.6340, 630.9302, 617.5189, 614.6273, 603.8510, 594.0626, 586.3117, 573.8658, 556.0497, 544.1482, 530.4134, 527.0664, 520.7791, 513.3237, 510.5996, 508.4171, 498.4122, 496.4037, 487.6434, 463.3516, 454.2925, 440.6554, 424.2555, 408.1419, 399.9993, 392.6421, 386.5330, 379.8915, 373.8859, 352.6395, 326.5201, 325.1588, 312.5401, 299.8591, 298.5799, 295.6649, 285.9930, 279.3142, 277.1524, 273.2435, 258.2945, 253.0175, 250.7744, 243.7118, 237.2744, 236.3001, 234.6547, 230.6115, 223.2595, 217.4771, 216.8802, 209.8726, 205.1653, 202.4718, 197.0995, 189.5264, 188.2560, 179.8629, 170.6283, 167.4009, 161.0373, 155.7810, 151.3474, 143.9820, 137.0876, 116.8908, 100.9725, 94.4215, 86.3152, 82.1442, 69.0790]
#
##==============================================================================


##==============================================================================
## 4xnh3@RuO2 frequency (cm-1)
#
#SURFACE = [3538.3506, 3522.0846, 3504.3004, 3489.0278, 3447.5464, 3431.0330, 3362.1889, 3258.9233, 3255.7080, 1641.6623, 1625.8851, 1614.2798, 1595.1031, 1576.7513, 1572.4746, 1134.0256, 1125.4126, 1088.5196, 701.7824, 698.8095, 677.5906, 673.7143, 661.4035, 653.9864, 649.6279, 634.6340, 630.9302, 617.5189, 614.6273, 603.8510, 594.0626, 586.3117, 573.8658, 556.0497, 544.1482, 530.4134, 527.0664, 520.7791, 513.3237, 510.5996, 508.4171, 498.4122, 496.4037, 487.6434, 463.3516, 454.2925, 440.6554, 424.2555, 408.1419, 399.9993, 392.6421, 386.5330, 379.8915, 373.8859, 352.6395, 326.5201, 325.1588, 312.5401, 299.8591, 298.5799, 295.6649, 285.9930, 279.3142, 277.1524, 273.2435, 258.2945, 253.0175, 250.7744, 243.7118, 237.2744, 236.3001, 234.6547, 230.6115, 223.2595, 217.4771, 216.8802, 209.8726, 205.1653, 202.4718, 197.0995, 189.5264, 188.2560, 179.8629, 170.6283, 167.4009, 161.0373, 155.7810, 151.3474, 143.9820, 137.0876, 116.8908, 100.9725, 94.4215, 86.3152, 82.1442, 69.0790]
#ADSORBENT = [3514.7068, 3504.7658, 3502.8463, 3501.7904, 3497.2234, 3476.8898, 3476.5165, 3470.6106, 3377.2802, 3375.2059, 3374.9269, 3372.9550, 1630.4427, 1625.4544, 1621.5364, 1598.4924, 1581.1795, 1562.3926, 1555.6025, 1554.1609, 1141.4182, 1116.3784, 1113.0267, 1081.3300, 677.2649, 660.5856, 655.5147, 647.1727, 646.4249, 642.4912, 638.4492, 633.5813, 628.9467, 626.2512, 623.6047, 606.8692, 599.6724, 597.2593, 587.7289, 579.9365, 567.6755, 551.4208, 539.6668,535.0977, 531.8157, 529.5289, 521.4793, 517.0632, 512.9307, 487.1523, 478.9462, 455.8745, 441.5086, 434.9488, 426.4511, 419.9776, 411.8630, 392.5270, 387.6045, 379.9874, 371.1105, 365.7610, 363.8466, 351.5325, 327.3807, 321.6176, 319.0822,303.1140, 294.1749, 289.2648, 286.6933, 282.0531, 268.8451, 259.3562, 258.4521, 252.4738, 239.6641, 238.0719, 236.0849, 234.2842, 227.4703, 225.8238, 221.4457, 221.1859, 217.7068, 213.9541, 201.3650, 201.0312, 193.2631, 190.8539, 179.7935, 178.8840, 175.1532, 169.9548, 167.0788 , 163.5298, 162.2637, 152.4989, 150.2554, 144.3532, 140.0210, 137.3102, 126.8377, 117.7284, 114.7335, 80.9575, 72.9625, 58.9734]
#
##==============================================================================


##==============================================================================
## 5xnh3@RuO2 frequency (cm-1)
#
#SURFACE = [3514.7068, 3504.7658, 3502.8463, 3501.7904, 3497.2234, 3476.8898, 3476.5165, 3470.6106, 3377.2802, 3375.2059, 3374.9269, 3372.9550, 1630.4427, 1625.4544, 1621.5364, 1598.4924, 1581.1795, 1562.3926, 1555.6025, 1554.1609, 1141.4182, 1116.3784, 1113.0267, 1081.3300, 677.2649, 660.5856, 655.5147, 647.1727, 646.4249, 642.4912, 638.4492, 633.5813, 628.9467, 626.2512, 623.6047, 606.8692, 599.6724, 597.2593, 587.7289, 579.9365, 567.6755, 551.4208, 539.6668,535.0977, 531.8157, 529.5289, 521.4793, 517.0632, 512.9307, 487.1523, 478.9462, 455.8745, 441.5086, 434.9488, 426.4511, 419.9776, 411.8630, 392.5270, 387.6045, 379.9874, 371.1105, 365.7610, 363.8466, 351.5325, 327.3807, 321.6176, 319.0822,303.1140, 294.1749, 289.2648, 286.6933, 282.0531, 268.8451, 259.3562, 258.4521, 252.4738, 239.6641, 238.0719, 236.0849, 234.2842, 227.4703, 225.8238, 221.4457, 221.1859, 217.7068, 213.9541, 201.3650, 201.0312, 193.2631, 190.8539, 179.7935, 178.8840, 175.1532, 169.9548, 167.0788 , 163.5298, 162.2637, 152.4989, 150.2554, 144.3532, 140.0210, 137.3102, 126.8377, 117.7284, 114.7335, 80.9575, 72.9625, 58.9734]
#ADSORBENT = [3510.4404, 3507.6823, 3503.2989, 3500.1740, 3497.7077, 3491.5360, 3490.1742, 3463.2313, 3430.3824, 3417.8857, 3399.6689, 3382.4819, 3355.0458, 3083.0570, 2909.1877, 1663.7079, 1654.1158, 1641.5590, 1621.1516, 1608.0998, 1604.8165, 1593.8781, 1579.3511, 1558.8963, 1551.1006, 1229.6167, 1152.5241, 1141.8436, 1107.5534 ,1089.4363, 802.2038, 682.1223, 676.1014, 656.7441, 654.3541, 648.2886, 641.7614, 636.2418, 633.7428, 628.4762, 618.7997, 616.3644, 611.5650, 608.0428, 584.6879, 578.2908, 568.5586, 552.9917, 539.7515, 531.4969, 526.5044, 523.2580, 520.6086, 518.4867, 505.7179, 501.1311, 485.4136, 483.4513, 451.6341, 443.0082, 435.7620, 428.7991, 425.1410, 424.6571, 409.9150, 396.9856,394.7299, 391.5977, 380.4228, 372.1468, 367.1466, 366.4210, 342.9297, 339.0658, 332.5775, 320.2730, 313.6033, 299.1002, 297.4909, 290.0550, 285.3590, 274.6259, 271.4394, 266.4791, 260.6597, 253.9947, 241.6462, 239.3227, 237.9773, 237.5316, 230.0476, 229.0354, 225.6660, 222.9829, 222.0538, 216.3983, 213.4118, 206.3434, 200.6764, 197.5354, 190.0162, 185.7481, 179.7952, 174.2884, 172.6316, 169.6265, 164.8679, 156.8333, 153.5034, 149.2018, 142.5414, 140.2008, 128.8044, 120.7438,107.3677, 96.5504, 88.6542, 83.7856, 66.4453, 25.7559]
#
##==============================================================================


H_eV = 4.135667662 * math.pow(10, -15)  # H_PLANCK_eV, eV.sec
C = 299792458  # speed of light m/s
HVS_SURFACE = [H_eV * C * (i * 100) * 1000 for i in SURFACE] # convert to meV
HVS_ADSORBENT = [H_eV * C * (i * 100)* 1000 for i in ADSORBENT]
KB_EV = 8.6173324 * math.pow(10, -5)  # K_BOLTZMANN_EV. eV/K

adsorbent = util.Adsorbent(HVS_SURFACE, HVS_ADSORBENT)
adsorbent.set_sys_parameter(LATTICE_A, LATTICE_B, ACTIVE_SITE, BETA, TOTAL_PRESSURE, TEMPERATURE)
adsorbent.set_gas_parameters(GAS_MASS, ROT_CONST_A, ROT_CONST_B, ROT_CONST_C, SIGMA, HVS_GAS)

d1 = adsorbent.get_E_t_list()


## normal distribution
#    
E_zpe = 1.4
#sigmas = []
#RMSs = []
#for sigma in np.linspace(0.01, 0.04, 7, endpoint=True):
#    print('sigma', sigma)
#    E_checks = []
#    N0_of_E_cals = []
#    square_dev_of_N0 = []
#    for E_check in np.linspace(E_zpe - 3 * sigma, E_zpe + 3 * sigma, 21, endpoint=True):
#        T = adsorbent.get_T(E_check)
#        adsorbent.temperature = T
#        fs = []
#        N0s_of_E_guess = []
#        for E in np.linspace(E_check - 2 * KB_EV * T, E_check + 4 * KB_EV * T, 256, endpoint=True):
#            f = adsorbent.get_f_energy_distribution(E)
#            fs.append(f)
#            N0s_of_E_guess.append(1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)))
#        rd_sec = [i * j * (6 * KB_EV * T / 255) for i, j in zip(fs, N0s_of_E_guess)]
#        rd = sum(rd_sec)
#        N0_of_E_cal = rd / (BETA * (E_check / T))
#        E_checks.append(E_check)
#        N0_of_E_cals.append(N0_of_E_cal)
#        square_dev_of_N0.append((N0_of_E_cal - 1/(sigma * np.sqrt(2 * np.pi))*np.exp( - (E_check - E_zpe)**2 / (2 * sigma**2))) ** 2)
#    E = np.linspace(E_zpe - 3 * sigma, E_zpe + 3 * sigma, 256, endpoint=True)
#    plt.plot(E, 1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)),linewidth=2, color='r')
#    plt.plot(E_checks, N0_of_E_cals)
#    sigmas.append(sigma)
#    RMSs.append(np.sqrt(sum(square_dev_of_N0)/21))
#    print(np.sqrt(sum(square_dev_of_N0)/21))
#    plt.show()
#plt.plot(sigmas, RMSs)

rds = []
Es=[]
sigma = 0.05
for T in np.linspace(327, 414, 30, endpoint=True):
    adsorbent.temperature = T
    E = adsorbent.get_E_star()
    N0 = 1/(sigma * np.sqrt(2 * np.pi)) * math.exp( - (E - E_zpe)**2 / (2 * sigma**2))
    rd = N0 * BETA * adsorbent.get_E_star() / T
    rds.append(rd)
    print(T, round(rd,5))
T = np.linspace(327, 414, 30, endpoint=True)
plt.plot(T, rds)
plt.show()
E = np.linspace(E_zpe - 3 * sigma, E_zpe + 3 * sigma, 256, endpoint=True)
plt.plot(E, 1/(sigma * np.sqrt(2 * np.pi)) * np.exp( - (E - E_zpe)**2 / (2 * sigma**2)))
    
    
print("--- %s seconds ---" % (time.time() - start_time))


        
if __name__ == "__main__":
    pass
