#!/usr/bin/env/python
# -*- coding: UTF-8 -*-

# 2016/10/1 Tino 1st

import numpy as np
import math

# CONSTANTS
M_NH3_KILOGRAM_PER_MOLE = (14.001 + 3 * 1.000) * 0.001  # MASS_OF_NH3_KILOGRAM_PER_MOLE. kg/mole
M_NH3 = M_NH3_KILOGRAM_PER_MOLE / (6 * math.pow(10, 23))  # MASS_OF_NH3, kg
KB_J = 1.38064852 * math.pow(10, -23)  # K_BOLTZMANN_J, J/K
KB_EV = 8.6173324 * math.pow(10, -5)  # K_BOLTZMANN_EV. eV/K
LATTICE_A = 9.49569  # Angstrom
LATTICE_B = 12.8097  # Angstrom
C_OF_ACTIVE_SITE = 6 / (LATTICE_A * LATTICE_B * math.pow(10, -20))  # CONC_OF_ACTIVE_SITE, number of site/m2
BETA = 3  # BETA_HEATING_RATE, K/s
H_J = 6.626070040 * math.pow(10, -34)  # H_PLANK_J, J.sec
# Rotational constants ( http://www.colby.edu/chemistry/PChem/scripts/ABC.html)
ROT_CONST_A_NH3 = 610.85  # 1/m
ROT_CONST_B_NH3 = 983.86  # 1/m
ROT_CONST_C_NH3 = 983.91  # 1/m
ROT_CONST_A_H2O = 921.21  # 1/m
ROT_CONST_B_H2O = 1391.9  # 1/m
ROT_CONST_C_H2O = 2724.1  # 1/m
SIGMA_NH3 = 3  # SYM_FACTOR_NH3
SIGMA_H2O = 2  # SYM_FACTOR_H2O


# variables
time = 0.00
temperature = 100 + BETA * time
total_pressure = 2 * math.pow(10, -10)  # Pa, （m·kg·s-2）/m^2
# total_pressure = 1.01325 * math.pow(10, 5)
volume_per_molecular = KB_J * temperature / total_pressure

# hvs_vib
hvs_surface = []
hvs_h2o_gas = []
hvs_1h2o = []
hvs_2h2o = []
hvs_3h2o = []
hvs_4h2o = []
hvs_5h2o = []
hvs_6h2o = []
hvs_7h2o = []
hvs_8h2o = []
hvs_9h2o = []
hvs_10h2o = []
hvs_11h2o = []
hvs_12h2o = []
hvs_13h2o = []
hvs_nh3_gas = [435.460659, 431.205986, 415.541526, 203.517923, 201.833141, 120.027150]
hvs_1nh3 = [430.198631, 427.540569, 413.961910, 198.085064, 197.954985, 155.888486, 100.626456, 96.913905, 91.150507, 90.571449, 89.577129, 89.333135, 88.593270, 88.076295, 87.886616, 86.694058, 83.365306, 81.745121, 80.947879, 80.185729, 79.852830, 78.509102, 78.224377, 75.948489, 75.623308, 75.216938, 73.746860, 73.650604, 70.716749, 70.119930, 69.654502, 69.168927, 68.939090, 65.750349, 64.807776, 64.321902, 64.119328, 63.509015, 61.902849, 61.104554, 60.901952, 60.668654, 60.155707, 59.358441, 58.895983, 44.163961, 42.740979, 37.943257, 36.766113, 35.552710, 35.284977, 34.827630, 34.380060, 34.257256, 33.587371, 33.302352, 33.108034, 30.834472, 30.731268, 30.660547, 30.331024, 30.283868, 30.224699, 29.193081, 28.773556, 28.233508, 27.796885, 27.517773, 27.211584, 26.602082, 26.049863, 24.195551, 22.550748, 22.217728, 21.832439, 21.661550, 21.522873, 21.328779, 20.743273, 20.667872, 20.507662, 20.257865, 19.767438, 19.121150, 18.917779, 18.821477, 18.724233, 18.552834, 17.980644, 17.809680, 17.072836, 16.866863, 16.051825, 15.705389, 15.338813, 14.747400]
hvs_2nh3 = [424.125172, 423.849717, 420.595920, 419.403011, 410.808280, 405.796797, 200.394007, 199.456838, 199.033067, 198.587343, 157.676765, 155.343118, 107.766780, 102.077340, 100.129117, 99.457258, 89.161474, 88.785527, 87.924722, 87.561085, 86.573713, 86.383606, 85.801908, 85.655321, 81.868313, 79.400476, 79.191369, 78.312681, 77.940721, 77.281795, 77.080852, 74.568861, 74.157690, 73.548951, 72.704997, 72.368210, 70.624597, 69.999068, 69.224256, 67.960474, 67.319906, 65.274200, 65.197919, 64.764850, 64.505284, 64.288516, 61.433483, 60.961585, 60.692938, 60.199048, 59.864068, 59.473005, 58.830080, 58.539293, 44.672150, 43.767245, 39.090709, 38.339463, 36.558748, 36.146206, 36.026258, 35.695262, 35.472710, 35.007167, 34.594195, 33.993084, 33.264194, 30.937056, 30.909414, 30.723105, 30.570799, 30.219125, 30.022164, 29.945579, 29.074837, 28.866068, 28.836132, 28.575930, 28.134741, 27.892153, 27.633395, 26.837740, 24.615636, 24.092543, 23.078251, 22.608815, 22.301980, 22.102627, 21.934406, 21.521768, 21.330050, 21.174876, 20.590801, 20.347330, 19.927018, 19.692588, 19.582158, 19.292423, 19.203925, 18.711171, 18.404162, 18.315183, 18.035711, 17.909694, 17.207706, 16.780799, 16.550679, 16.327247]
hvs_3nh3 = []
hvs_4nh3 = []
hvs_5nh3 = []
hvs_6nh3 = []
hvs_7nh3 = []
hvs_8nh3 = [438.775021, 437.949482, 436.762264, 434.440552, 434.224810, 433.305892, 432.869853, 430.898249, 429.174646, 424.632318, 417.025527, 416.210198, 415.160595, 414.916849, 405.276550, 400.388275, 398.213399, 397.295026, 384.416548, 378.127641, 375.614944, 370.993282, 368.501827, 359.582767, 207.444471, 207.409741, 205.280089, 204.153621, 202.911506, 201.748168, 201.510384, 200.866881, 199.302470, 197.883944, 197.787287, 196.461653, 195.927557, 194.143759, 192.558326, 189.494023, 159.954281, 158.666879, 154.332279, 153.377912, 151.521138, 148.318138, 143.690381, 141.229537, 114.491228, 110.644835, 110.088544, 107.387422, 103.711298, 96.390154, 95.985387, 93.789589, 92.729083, 91.896251, 88.807374, 88.359045, 87.512865, 87.344311, 87.180092, 86.600460, 84.700966, 84.300609, 83.905633, 82.422198, 82.029553, 80.033003, 79.798866, 78.969876, 78.900595, 78.619604, 78.352295, 78.014023, 77.415660, 77.377770, 77.140524, 76.977920, 76.645670, 76.227718, 75.652339, 74.704802, 74.294421, 74.065609, 71.562409, 71.302271, 69.842583, 68.764089, 68.492020, 68.117597, 68.072134, 67.842909, 67.610342, 67.351216, 66.918122, 66.794661, 66.631435, 65.973567, 65.425946, 64.547911, 63.011055, 62.663099, 60.946491, 60.650289, 60.319028, 59.415086, 58.883405, 58.637473, 58.357056, 58.108167, 57.879420, 56.677974, 56.642106, 56.122617, 55.894296, 55.644248, 55.224567, 54.953502, 54.435730, 54.044792, 52.591050, 51.567588, 49.972169, 46.763875, 46.504837, 45.687287, 44.154833, 43.054171, 42.002636, 41.606439, 41.061790, 40.575010, 40.231998, 39.796632, 39.299857, 39.129521, 37.518787, 37.334380, 36.517399, 36.401780, 35.418618, 35.205894, 34.773066, 34.328836, 33.959777, 33.728519, 33.154625, 32.737278, 32.343393, 31.587695, 31.459209, 31.183585, 30.790076, 30.610472, 30.491323, 30.020316, 29.291148, 28.887931, 28.136621, 27.694186, 27.602131, 27.464970, 26.745447, 26.491955, 26.382949, 26.200079, 25.930871, 25.744195, 25.510992, 25.233108, 24.873796, 24.364129, 23.374246, 22.947384, 22.461385, 21.875663, 21.621070, 21.361996, 20.751192, 20.558949, 20.253127, 19.975773, 19.662552, 19.334944, 18.967115, 18.914271, 18.544925, 18.416279, 17.916372, 17.721331, 17.414130, 16.978171, 16.891663, 16.613361, 16.422280, 15.901451, 15.481372, 15.062699, 14.532694, 13.677767, 13.312180, 12.997102, 12.724327, 12.351176]
hvs_9nh3 = [438.400838, 437.426952, 436.856151, 435.098928, 434.373205, 433.244433, 428.414876, 428.221452, 425.105739, 420.150207, 418.816556, 416.738576, 412.883411, 412.794755, 409.636380, 409.039463, 408.229541, 407.333891, 404.043903, 401.283305, 399.204731, 393.991062, 390.195490, 390.013912, 373.477915, 368.199742, 360.407510, 207.228709, 206.575907, 205.761269, 204.841750, 203.862327, 202.828187, 202.601596, 202.046069, 201.522844, 199.048709, 197.629544, 197.564413, 196.050050, 195.477893, 194.987669, 193.807827, 191.652566, 189.805910, 164.155072, 159.662717, 155.726691, 153.994060, 152.561196, 151.923061, 149.766683, 142.706032, 140.400969, 115.363068, 112.621640, 111.759628, 108.022015, 100.247531, 98.139500, 96.967850, 96.577080, 96.493026, 93.010138, 89.215705, 88.576768, 88.224616, 88.014908, 87.687588, 86.926529, 85.856365, 85.139596, 84.748287, 84.234442, 82.806485, 80.732511, 80.647112, 79.734675, 79.633487, 79.335645, 79.098958, 78.653635, 78.320708, 78.090900, 77.711991, 77.390292, 77.316945, 75.514478, 74.855865, 74.605941, 74.456907, 73.811593, 72.071250, 71.565081, 69.372469, 69.295918, 68.938602, 68.515948, 68.306077, 68.200187, 68.073837, 67.937463, 67.615593, 67.109368, 66.991016, 65.757083, 65.085513, 64.642536, 63.116049, 62.903790, 61.247710, 60.981324, 60.929437, 60.562556, 59.900084, 59.645866, 59.200859, 58.756529, 58.291131, 57.626015, 57.351353, 57.010207, 56.529574, 56.317068, 56.051189, 55.707981, 55.164793, 54.672073, 54.268747, 52.788343, 51.112852, 50.724546, 48.895853, 46.403126, 45.543278, 45.147815, 44.244057, 43.460902, 43.192606, 41.886487, 41.165628, 40.895522, 40.502111, 40.102448, 39.389302, 39.026663, 38.574104, 37.715438, 36.990913, 36.601210, 36.372928, 35.601405, 35.128943, 34.943617, 33.848167, 33.576442, 33.259202, 33.049040, 32.817600, 32.138129, 31.827532, 30.977901, 30.778342, 30.661845, 30.254351, 30.054492, 29.799698, 29.393301, 28.801856, 28.478613, 28.302145, 27.843784, 27.750947, 27.404376, 26.934111, 26.501411, 26.289625, 25.854916, 25.709295, 25.469574, 25.279792, 25.111201, 24.491124, 24.001908, 23.536599, 22.566786, 21.939120, 21.547191, 21.440833, 20.884407, 20.705424, 20.495739, 20.279331, 19.684001, 19.529093, 19.412187, 18.957337, 18.786555, 18.574201, 18.197783, 18.044199, 17.968685, 17.856068, 17.660940, 17.327263, 17.055762, 16.643211, 16.266531, 15.940985, 15.808013, 15.278258, 14.948776, 14.841765, 13.975914, 13.344724, 12.808389, 11.826654, 11.543892]
hvs_10nh3 = []
hvs_11nh3 = []
hvs_12nh3 = []
hvs_13nh3 = []

# hvs_molecular

# method()
# def get_translation_partition_function(mass):
#     qts_at_T = []  # qt = translation_partition_functions
#     for t in np.linspace(50, 500, 20):  # t = temperature
#         qt = (2 * np.pi * mass * KB_J * t / (H_J ** 2)) ** 1.5
#         qts_at_T.append(qt)
#     return qts_at_T

def get_translation_partition_function(mass, temperature, pressure):
    volume = KB_J * temperature / pressure
    Lambda = np.sqrt((H_J ** 2) / (2 * np.pi * mass * KB_J * temperature))
    qt = volume / (Lambda ** 3)
    return qt

# def get_rotation_partition_function_nonlinear(symmetry_factor, rotational_constant_A, rotational_constant_B, rotational_constant_C):
#     qrs_nonlinear_at_T = []  # qr = translation_rotation_functions
#     t = 273  # t= temperature
#     qr_nonlinear = 1 / symmetry_factor * (((KB_J * t / (H_J * 3 * math.pow(10, 8))) ** 1.5) * \
#     np.sqrt(np.pi / (rotational_constant_A * rotational_constant_B * rotational_constant_C))
#     qrs_nonlinear_at_T.append(qr_nonlinear)
#     return qrs_nonlinear_at_T

def get_rotation_partition_function_nonlinear(symmetry_factor, rotational_constant_A, rotational_constant_B, rotational_constant_C):
    qrs_nonlinear_at_T = []  # qr = translation_rotation_functions
    t = 273  # t= temperature
    qr_nonlinear = 1 / symmetry_factor * (((KB_J * t / (H_J * 3 * math.pow(10, 8))) ** 1.5) * np.sqrt(np.pi / (rotational_constant_A * rotational_constant_B * rotational_constant_C))
    qrs_nonlinear_at_T.append(qr_nonlinear)
    return qrs_nonlinear_at_T

def get_vibration_partition_function(hvs):
    qvs_at_T = []  # qv = partition_function
    for t in np.linspace(50, 500, 20):  # t= temperature
        partition_function = [1.0 / (1.0 - math.exp(-1 * hv * math.pow(10, -3) / (KB_EV * t))) for
                              hv in hvs]
        qvs_at_T.append(np.prod(partition_function))
        # print(np.prod(partition_function))
    return qvs_at_T


def get_gas_molecular_partition_function(gas_molecular):
    # qt = get_translation_partition_function(M_NH3)
    qr = get_rotation_partition_function_nonlinear(SIGMA_NH3, ROT_CONST_A_NH3, ROT_CONST_B_NH3, ROT_CONST_C_NH3)
    qv = get_vibration_partition_function(hvs_nh3_gas)
    gas_molecular_partition_functions_at_T = [i * j * k for i, j, k in zip(qt, qr, qv)]
    # gas_molecular_partition_functions_at_T = [j * k for j, k in zip(qr, qv)]
    return gas_molecular_partition_functions_at_T

def get_rate_const_adsorption():
    rate_const_adsorptions = []
    for t in np.linspace(50, 500, 20):  # t= temperature
        rate_const_adsorption = total_pressure / (
            np.sqrt(2 * np.pi * M_NH3 * KB_J * t) * C_OF_ACTIVE_SITE)
        rate_const_adsorptions.append(rate_const_adsorption)
    return rate_const_adsorptions

# def get_pre_exponential_factor():
#     pre_exponential_factors = []
#     Edes = 0.8412 #eV
#     for temperature in np.linspace(50, 500, 20):
#         rate_const_adsorptions = []
#         rate_const_adsorptions.append(rate_const_adsorption)
#     print(rate_const_adsorptions)


# Temp,Coverage_NH3 vs pre-exponential factor
# print(get_translation_partition_function(M_NH3))
print(get_translation_partition_function(M_NH3, 298, 1.01325 * math.pow(10, 5)))
# print(get_rotation_partition_function_nonlinear(SIGMA_NH3, ROT_CONST_A_NH3, ROT_CONST_B_NH3, ROT_CONST_C_NH3))
# print(get_vibration_partition_function(hvs_nh3_gas))
#
# print(get_vibration_partition_function(hvs_nh3_gas))
# print(get_vibration_partition_function(hvs_1nh3))
# print(get_vibration_partition_function(hvs_2nh3))
# print(get_rate_const_adsorption())
# print(get_vibration_partition_function(hvs_9nh3))
# print(get_pre_exponential_factor())

